---
head.title: 'Laravel Task Scheduler with Docker - Docker PHP - Server Side Up'
description: 'Learn how to configure a Laravel Task Scheduler with Docker.'
layout: docs
title: Task Scheduler
---

## Laravel Task Scheduler with Docker
Running a Laravel task scheduler with Docker can be a little different from traditional methods.

## Important concepts
::tip{to="https://getspin.pro/docs/services/laravel-scheduler" target="_blank"}
Want to skip the setup? [Spin Pro](https://getspin.pro/docs/services/laravel-scheduler){target="_blank"} handles Laravel schedulers on your VPS with Docker and zero-downtime deploymentsâ€”all configured for you.
::

1. If you're using `fpm-apache` or `fpm-nginx`, might need to set the stop signal to `SIGTERM` for a graceful shutdown (see this [PR](https://github.com/serversideup/docker-php/pull/437){target="_blank"} for more details why)
1. Be sure to set the health check
1. We will **not** use `cron` to run the scheduler
1. By default `schedule:work` checks every minute, so we will use that to run the system process
1. The actual time trigger itself is set within Laravel

## More detail
We need to run the [schedule:work](https://laravel.com/docs/12.x/scheduling#running-the-scheduler-locally){target="_blank"} command from Laravel. Although the docs say "Running the scheduler locally", this is what we want in production. It will run the scheduler in the foreground and execute it every minute. You can configure your Laravel app for the exact time that a command should run through a [scheduled task](https://laravel.com/docs/12.x/scheduling#scheduling-artisan-commands){target="_blank"}.


## Examples
Here is a simplified example of how you can achieve this with Docker Compose:

::note
Notice we're calling the artisan command explicitly with the full path (`/var/www/html/artisan`). This is because we need to run the command from the context of the container.
::

#### Example & Simplified Docker Compose File
```yaml [docker-compose.yml]
services:
  php:
    image: my/laravel-app

  task:
    image: my/laravel-app
    command: ["php", "/var/www/html/artisan", "schedule:work"]
    stop_signal: SIGTERM # Set this for graceful shutdown if you're using fpm-apache or fpm-nginx
    healthcheck:
      # This is our native healthcheck script for the scheduler
      test: ["CMD", "healthcheck-schedule"]
      start_period: 10s
```


#### Example in Laravel
::note
This example is for Laravel version <= 10.
::

This is an example how we would set the actual execution time within Laravel itself:
```php [app/Console/Kernel.php]
<?php

namespace App\Console;

use Illuminate\Console\Scheduling\Schedule;
use Illuminate\Foundation\Console\Kernel as ConsoleKernel;

class Kernel extends ConsoleKernel
{
    /**
     * The Artisan commands provided by your application.
     *
     * @var array
     */
    protected $commands = [
        //
    ];

    /**
     * Define the application's command schedule.
     *
     * @param  \Illuminate\Console\Scheduling\Schedule  $schedule
     * @return void
     */
    protected function schedule(Schedule $schedule)
    {
        $schedule->command('process:invoices')->daily()->at('02:00')->timezone('America/Chicago');
        $schedule->command('process:latefees')->daily()->at('04:00')->timezone('America/Chicago');
    }

    /**
     * Register the commands for the application.
     *
     * @return void
     */
    protected function commands()
    {
        $this->load(__DIR__.'/Commands');

        require base_path('routes/console.php');
    }
}
```

```php [routes/console.php]
<?php
 
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Schedule;
 
Schedule::call(function () {
    DB::table('recent_users')->delete();
})->daily()->at('04:00')->timezone('America/Chicago');
```